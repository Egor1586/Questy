{% extends "base.html" %}

{% block title %}
    Result test online
{% endblock %}

{% block links %}
    <link rel = "stylesheet" href = "{{ url_for('test_app.static', filename='css/review_results.css') }}">
{% endblock %}

{% block content %}
    <div class="container">
        <div class="result-info">
            <div class="test-info">
                {% if username %}
                    <p><strong>{{ username }}</strong>, ваш результат: <strong>{{ count_correct_answers }} </strong>/ <strong>{{ total_question }}</strong></p>
                {% else %}
                    <p>Ваш результат: <strong>{{ count_correct_answers }}</strong> з {{ total_questions }}</p>
                {% endif %}
                
                <p>Точність правильних відповідей: <strong>{{ accuracy }}%</strong></p>

                {% if bask_to_class %}
                    <a class="home-link" href="/class_courses{{ bask_to_class }}">
                        <button class="home-btn">До класу</button>
                    </a>
                {% else %}
                    <a class="home-link" href="/profile">
                        <button class="home-btn">До профiлю</button>
                    </a>
                {% endif %}
            </div>

            <div class="answer-info">
                <ul>
                    <li><span class="color-dot color-green"></span>Правильна відповідь (зелений)</li>
                    <li><span class="color-dot color-yellow"></span>Ваша неправильна відповідь (жовтий)</li>
                    <li><span class="color-dot color-red"></span>Неправильна відповідь (червоний)</li>
                </ul>
            </div>
        </div>

            
        {% if not username %}
            <div class="user-information">
                <div class="auth-block">
                    <p>Якщо ви хочете відстежувати свій прогрес у Qusty - створіть свій аккаунт та стежте за своїм прогресом</p>
                    <a href="/sign_up" class="auth-btn">Реєстрація</a>
                </div>
        
                <div class="auth-block">
                    <p>Якщо у вас вже є аккаунт - авторизуйтесь</p>
                    <a href="login" class="auth-btn">Авторизація</a>
                </div>
            </div>
        {% endif %}
            
        {% for question in list_quiz %}
            {% set answers = list_answers[loop.index0] %}
            {% set user_answer = user_answers[loop.index0] %}
            <div class="question-block">
                <div class="question-header">
                    <div>{{ question.question_text }}</div>
                </div>

                <div class="question-text">
                    Ваш правильний варіант.
                </div>
                {% for answer in answers %}
                    {% if answer != question.correct_answer and answer != user_answer%}
                        <div class="answer incorrect">✗ {{answer}}</div>   
                    {% elif user_answer != question.correct_answer and user_answer == "not_answer" %}      
                        <!-- Якщо неправильна відповідь -->
                        <div class="answer no-answer">Відповідь відсутня</div>
                    {% elif user_answer != question.correct_answer and answer == user_answer %}
                        <div class="answer user_answers">✗ {{answer}}</div>
                    {% else %}
                        <div class="answer correct">✓ {{ answer }}</div>
                    {% endif %}
                {% endfor %}
            </div>
        {% endfor %}
    </div>
{% endblock %}